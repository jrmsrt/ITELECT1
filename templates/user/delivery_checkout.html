{% extends 'user/main_header.html' %}

{% block content %}

<title>Checkout - BookHaven</title>
<link rel="stylesheet" href="{{ url_for('static', filename='css/user/delivery_checkout.css') }}">
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="/static/js/address.js"></script>

<div class="checkout-container">
  <!-- LEFT SECTION -->
  <div class="checkout-details">
    <h2>Checkout Details</h2>
    <p class="subtext">Please enter your information to complete the order.</p>

    <h3><i class="fa-solid fa-location-dot"></i> Shipping Address</h3>

    <div class="form-grid">
      <div class="form-group">
        <label>Full Name</label>
        <input type="text" placeholder="Enter your full name">
      </div>
      <div class="form-group">
        <label>Email</label>
        <input type="email" placeholder="Enter your email">
      </div>
      <div class="form-group">
        <label>Phone Number</label>
        <input type="text" placeholder="09XXXXXXXXX">
      </div>

      <div class="form-group">
        <label>Region</label>
        <select id="region"><option>Select Region</option></select>
        <input type="hidden" id="region-text">
      </div>

      <div class="form-group">
        <label>Province</label>
        <select id="province"><option>Select Province</option></select>
        <input type="hidden" id="province-text">
      </div>

      <div class="form-group">
        <label>City/Municipality</label>
        <select id="city"><option>Select City/Municipality</option></select>
        <input type="hidden" id="city-text">
      </div>

      <div class="form-group">
        <label>Barangay</label>
        <select id="barangay"><option>Select Barangay</option></select>
        <input type="hidden" id="barangay-text">
      </div>

      <div class="form-group">
        <label>ZIP Code</label>
        <input type="text" id="zip" placeholder="Auto-filled" required>
      </div>

      <div class="form-group full">
        <label>Street Address</label>
        <input type="text" placeholder="House number, street, etc.">
      </div>
    </div>

    <div class="section">
      <h3><i class="fa-solid fa-money-bill"></i> Payment Method</h3>
      <div class="payment-options">
        <div class="payment-option active" id="cod">
          <i class="fa-solid fa-dollar-sign"></i> Cash on Delivery
        </div>
        <div class="payment-option" id="online">
          <i class="fa-solid fa-credit-card"></i> Online Payment
        </div>
      </div>
    </div>
  </div>

  <!-- RIGHT SECTION -->
<!-- RIGHT SECTION -->
<div class="order-summary">
    <h2><i class="fa-solid fa-cart-shopping"></i> Order Summary</h2>

    <div class="order-items">

      {% if items %}
        {% for item in items %}
        <div class="item">
          <img src="{{ url_for('static', filename='uploads/' ~ item.cover) if item.cover else url_for('static', filename='images/no-cover.png') }}"
               alt="{{ item.title }}">

          <div class="details">
            <h4>{{ item.title }}</h4>
            <p class="author">by {{ item.author }}</p>
            <p class="genre">{{ item.genre }}</p>
          </div>

          <div class="price">
            <strong>₱{{ "{:,.2f}".format(item.price) }}</strong>
            <p>Qty: {{ item.quantity }}</p>
          </div>
        </div>
        {% endfor %}
      {% else %}
        <p>No items selected.</p>
      {% endif %}

    </div>

  <!-- ORDER TOTALS -->
  <div class="order-totals">
    
    {% set vat = (subtotal * 12 / 112) %}
    {% set net = subtotal - vat %}
    {% set total = subtotal %}

    <p>
      <span>Subtotal ({{ total_books }} item{{ 's' if total_books != 1 else '' }})</span>
      <span>₱{{ "{:,.2f}".format(net) }} <small style="color:#777;">(VAT-excl)</small></span>
    </p>

    <p><span>Shipping</span><span>FREE</span></p>

    <p>
      <span>VAT (12%)</span>
      <span>₱{{ "{:,.2f}".format(vat) }}</span>
    </p>

    <hr>

    <h3 class="total">
      <span>Total</span>
      <span>₱{{ "{:,.2f}".format(total) }} <small style="color:#777;">(VAT-incl)</small></span>
    </h3>
  </div>

{% endblock %}
