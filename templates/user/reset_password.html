{% extends 'user/form_header.html' %}

{% block content %}

<title>Reset Password - BookHaven</title>
<link rel="stylesheet" href="{{ url_for('static', filename='css/user/reset_password.css') }}">

<main class="main-container">
    <div class="card">
        <div class="card-header">
            <h1 class="card-title">Reset Your Password</h1>
            <p class="card-description">
                Enter a new password for your account. Make sure it's strong and secure.
            </p>
        </div>

        <div id="success-message" class="success-message">
            Your password has been successfully reset! You can now sign in with your new password.
        </div>

        <div id="error-message" class="error-message">
            Please fix the errors below before submitting.
        </div>

        <form id="reset-password-form" method="post" action="">
            <div class="form-group">
                <label for="password" class="label">New Password</label>
                <div class="password-wrapper">
                    <input 
                        type="password" 
                        id="password" 
                        name="password" 
                        class="input" 
                        placeholder="Enter your new password"
                        required
                    >
                    <i class="fa fa-eye toggle-password" data-target="password" id="togglePassword"></i>
                </div>
            </div>

            <div class="form-group">
                <label for="confirmPassword" class="label">Confirm New Password</label>
                <div class="password-wrapper">
                    <input 
                        type="password" 
                        id="confirmPassword" 
                        name="confirmPassword"
                        class="input" 
                        placeholder="Confirm your new password"
                        required
                    >
                    <i class="fa fa-eye toggle-password" data-target="confirmPassword" id="toggleConfirmPassword"></i>
                </div>
            </div>

            <div class="password-requirements">
                <h4>Password Requirements:</h4>
                <ul>
                    <li id="length-req">
                        <span class="requirement-icon invalid">✗</span>
                        At least 8 characters long
                    </li>
                    <li id="uppercase-req">
                        <span class="requirement-icon invalid">✗</span>
                        Contains uppercase letter
                    </li>
                    <li id="lowercase-req">
                        <span class="requirement-icon invalid">✗</span>
                        Contains lowercase letter
                    </li>
                    <li id="number-req">
                        <span class="requirement-icon invalid">✗</span>
                        Contains a number
                    </li>
                    <li id="special-req">
                        <span class="requirement-icon invalid">✗</span>
                        Contains special character (!@#$%^&*)
                    </li>
                </ul>
            </div>

            <button type="submit" class="button" id="submit-button">
                Reset Password
            </button>
            
            <div class="back-link">
                <a href="{{ url_for('user_login') }}">Back to Sign In</a>
            </div>
            <script src="/static/js/reset_password.js"></script>
            <script src="/static/js/toggle_password.js"></script>
        </form>
    </div>
</main>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

{% if msg_type == 'success' %}
<script>
Swal.fire({
    title: "Password Reset!",
    text: "{{ msg|e }}",
    icon: "success",
    confirmButtonColor: "#4a6cf7",
    confirmButtonText: "Continue",
    allowOutsideClick: false,
    allowEscapeKey: false,
    customClass: {
        confirmButton: 'swal-confirm-btn'
    }
}).then(() => {
    window.location.href = "{{ url_for('user_login') }}";
});
</script>
{% endif %}

{% endblock %}